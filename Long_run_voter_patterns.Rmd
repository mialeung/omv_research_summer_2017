file---
title: "Long Run Voter Patterns"

output: html_document
---
## Question
What is the long-run pattern of voter registration in Oregon? How has this changed with the start of AVR?
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(foreign)
library(readxl)
```


```{r import, include=T}
setwd("~/Google Drive/Research/AVR/data/Monthly_Voter_Registration Reports/xlsx_Versions_by_Year/")

# First get a vector list of the file names we want to process

file_names <- list.files(pattern = "*.xlsx", include.dirs = TRUE, full.names = TRUE,
                        recursive = TRUE)

# However, the files that are stored in the "2012" directory are not in a compatible
# format, so we need to remove these from the vector

# NOTE if you receive an error that a file cannot be opened with a pattern
# "./YYYY/~..." this is because you have Excel open. Close Excel.

file_names <- file_names[(substr(file_names,3,6) != "2012")]

# Now create a function to read in the Excel files, and capture the filename 
# as a variable. We will use this to create a month and year 

read.myfiles <- function(filename) {

  d <- read_xlsx(filename, sheet = "Raw Data") %>% 
  mutate(name = filename)
}

mydata <- lapply(file_names, read.myfiles)
mydata2 <- bind_rows(mydata)


```
